{% extends 'shop/basic.html' %}
{% block title %} Category {% endblock %}
{% block css %}

<!--body .no-padding{-->
<!--padding-left: 0px;-->
<!--padding-right: 0px;-->
<!--}-->
<!--body{-->
<!--padding-top : 105px;-->
<!--}-->

<!--@media (max-width: 991px)-->
<!--{-->
<!--    body-->
<!--    {-->
<!--        padding-top:75px;-->
<!--}-->
<!--}-->

<!--@media (max-width: 575px)-->
<!--{-->
<!--    body-->
<!--    {-->
<!--        padding-top:115px;-->
<!--}-->
<!--}-->

<!--body {-->
<!--            padding: 100px;-->

<!--        }-->

<!--        @media (min-width: 992px) {-->
<!--            .animate {-->
<!--                animation-duration: 0.3s;-->
<!--                -webkit-animation-duration: 0.3s;-->
<!--                animation-fill-mode: both;-->
<!--                -webkit-animation-fill-mode: both;-->
<!--            }-->
<!--        }-->
<!--        body {-->
<!--                padding-left: 20px;-->
<!--                padding-right: 20px;-->
<!--            }-->

<!--        @keyframes slideIn {-->
<!--            0% {-->
<!--                transform: translateY(1rem);-->
<!--                opacity: 0;-->
<!--            }-->

<!--            100% {-->
<!--                transform: translateY(0rem);-->
<!--                opacity: 1;-->
<!--            }-->

<!--            0% {-->
<!--                transform: translateY(1rem);-->
<!--                opacity: 0;-->
<!--            }-->
<!--        }-->

<!--        @-webkit-keyframes slideIn {-->
<!--            0% {-->
<!--                -webkit-transform: transform;-->
<!--                -webkit-opacity: 0;-->
<!--            }-->

<!--            100% {-->
<!--                -webkit-transform: translateY(0);-->
<!--                -webkit-opacity: 1;-->
<!--            }-->

<!--            0% {-->
<!--                -webkit-transform: translateY(1rem);-->
<!--                -webkit-opacity: 0;-->
<!--            }-->
<!--        }-->

<!--        .slideIn {-->
<!--            -webkit-animation-name: slideIn;-->
<!--            animation-name: slideIn;-->
<!--        }-->

<!--        .fo {-->
<!--            font-family: 'Roboto', sans-serif;-->

<!--        }-->

<!--        @media (max-width: 991px) {-->
<!--            .container {-->
<!--                padding: 0;-->
<!--                margin: 0;-->
<!--            }-->

<!--            body {-->
<!--                padding: 12px;-->
<!--                padding-top: 70px;-->
<!--                padding-left: 20px;-->
<!--                padding-right: 20px;-->
<!--            }-->

<!--            .navbar-fixed-top,-->
<!--            .navbar-fixed-bottom,-->
<!--            .navbar-static-top {-->
<!--                margin-left: 0;-->
<!--                margin-right: 0;-->
<!--                margin-bottom: 0;-->
<!--            }-->
<!--        }-->
<!--        @media (max-width: 500px) {-->
<!--            .container {-->
<!--                padding: 0;-->
<!--                margin: 0;-->
<!--            }-->

<!--            body {-->
<!--                padding: 12px;-->
<!--                padding-top: 1005px;-->
<!--            }-->

<!--            .navbar-fixed-top,-->
<!--            .navbar-fixed-bottom,-->
<!--            .navbar-static-top {-->
<!--                margin-left: 0;-->
<!--                margin-right: 0;-->
<!--                margin-bottom: 0;-->
<!--            }-->
<!--            .car{-->
<!--                padding: 30px;-->
<!--            }-->
<!--        }-->

.col-md-3 img
{
width: 270px;
height: 250px;
}
.col-md-3
{
display: inline-block;
margin-left:-4px;
}

.carousel-indicators .active {
background-color: blue;
}

.col-md-3 img{
max-width: 255px;
height: 200px;
}

body .carousel-indicator li{
background-color: blue;
}

body .carousel-indicators{
bottom: -40px;
}

.carousel-indicators li {
background-color: #7270fc;
}

body .carousel-control-prev-icon,
body .carousel-control-next-icon{
background-color: blue;
}


.pr{
top: auto;
bottom: auto;
padding-top: 222px;
}

.ne{
top: auto;
bottom: auto;
padding-top: 222px;
}

body .k
{
    background-color: rgba(0, 0, 0, 0);
    padding: 15% 15%;
}

.k{
    background-color: rgb(255, 0, 0);
}

body .no-padding{
padding-left: 10px;
padding-right: 10px;
}
body{
padding-top : 105px;
}

@media (max-width: 991px)
{
    body
    {
        padding-top:75px;
}
}

@media (max-width: 575px)
{
    body
    {
        padding-top:115px;
}
}

body {
            padding: 100px;

        }

        @media (min-width: 992px) {
            .animate {
                animation-duration: 0.3s;
                -webkit-animation-duration: 0.3s;
                animation-fill-mode: both;
                -webkit-animation-fill-mode: both;
            }
        }
        body {
                padding-left: 20px;
                padding-right: 20px;
            }

        @keyframes slideIn {
            0% {
                transform: translateY(1rem);
                opacity: 0;
            }

            100% {
                transform: translateY(0rem);
                opacity: 1;
            }

            0% {
                transform: translateY(1rem);
                opacity: 0;
            }
        }

        @-webkit-keyframes slideIn {
            0% {
                -webkit-transform: transform;
                -webkit-opacity: 0;
            }

            100% {
                -webkit-transform: translateY(0);
                -webkit-opacity: 1;
            }

            0% {
                -webkit-transform: translateY(1rem);
                -webkit-opacity: 0;
            }
        }

        .slideIn {
            -webkit-animation-name: slideIn;
            animation-name: slideIn;
        }

        .fo {
            font-family: 'Roboto', sans-serif;

        }

        @media (max-width: 991px) {
            .container {
                padding: 0;
                margin: 0;
            }

            body {
                padding: 12px;
                padding-top: 70px;
                padding-left: 20px;
                padding-right: 20px;
            }

            .navbar-fixed-top,
            .navbar-fixed-bottom,
            .navbar-static-top {
                margin-left: 0;
                margin-right: 0;
                margin-bottom: 0;
            }
        }
        @media (max-width: 500px) {
            .container {
                padding: 0;
                margin: 0;
            }

            body {
                padding: 12px;
<!--                padding-top: 1005px;-->
            }

            .navbar-fixed-top,
            .navbar-fixed-bottom,
            .navbar-static-top {
                margin-left: 0;
                margin-right: 0;
                margin-bottom: 0;
            }
            .car{
                padding: 30px;
                padding-top: 0px;
            }
        }

{% endblock %}

{% block css2 %}
@media (max-width: 575px)
{
    body
    {
        padding-top:160px;
    }
}

.card {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
}
{% endblock %}

{% block body %}
{% load static %}

<div class="jumbotron" style="margin-top:-60px;margin-bottom:0">
<nav aria-label="breadcrumb">
    <h4>
        <ol class="breadcrumb" style="border:1px solid grey;background-color:white">
            <li class="breadcrumb-item"><a href="http://127.0.0.1:8000/shop/">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{categoryy}}</li>
        </ol>
    </h4>
</nav>
<!--<div class="mx-4"><h3>{{categ.0}}</h3></div>-->
    <!--    <div class="container">-->
    <div class="row">
        <div class="col">
            <div class="row">
                {% for i in catprods %}
                <div class="col-12 col-sm-6 col-md-6 col-lg-4 mt-1 car">
                    <a href="/shop/products/{{i.id}}">
                    <div class="card">
<!--                        <img class="card-img-top" src="https://i.ibb.co/qDSmTtr/Adobe-Post-20200815-2243010-9207968215752862.png" alt="Card image cap">-->
                        <a href="/shop/products/{{i.id}}">
                        <img class="card-img-top " src='/media/{{i.image}}' alt="Card image cap">
                        </a>
                        <div class="card-body">
<!--                            <h4 class="card-title"><a href="/shop/products/{{i.id}}"><div  id="namepr{{i.id}}">{{i.product_name|slice:"0:20"}}{% if i.product_name|length > 20 %}...{% endif %}</div></a></h4>-->
<!--                            <p class="card-text">{{i.desc|slice:"0:30"}}{% if i.desc|length > 30 %}...{% endif %}</p>-->
                            <h5 class="card-title" style="margin-bottom:5px"><a href="/shop/products/{{i.id}}">{{i.product_name|slice:"0:22"}}{% if i.product_name|length > 22 %}...{% endif %}</a></h5>
                            <p class="card-text" style="margin: 0">{{i.desc|slice:"0:28"}}{% if i.desc|length > 28 %}...{% endif %}<br>M.R.P <del>₹{{i.cutprice}}</del><br></p>
                            <h6 class="card-title">₹ <span >{{i.price}} <span id="savepr{{i.id}}"><i style="color:#00A100"> Save ₹ {{i.you_save}}</i></span></span></h6>
<!--                            <div class="row">-->
<!--                                <div class="col">-->
<!--                                    <button type="button" class="btn btn-success" disabled><b>₹<span id="pricepr{{i.id}}">{{i.price}}</span></b></button>-->
<!--                                </div>-->
<!--&lt;!&ndash;                                <div class="col">&ndash;&gt;-->
<!--&lt;!&ndash;                                    <span id="divpr{{i.id}}" class="divpr">&ndash;&gt;-->
<!--&lt;!&ndash;                                        <button id="pr{{i.id}}" class="btn btn-primary cart" style="float:right">Add to cart</button>&ndash;&gt;-->
<!--&lt;!&ndash;                                    </span>&ndash;&gt;-->
<!--&lt;!&ndash;                                </div>&ndash;&gt;-->
<!--                            </div>-->
                        </div>
                    </div>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block js %}
<script>

    $('#popcart1').popover();

    mail = JSON.parse(localStorage.getItem('mail'));

    if (localStorage.getItem('mail') == null){
<!--        pops="<a href='/shop/login'><button class='btn btn-primary'>Log-in</button></a><a href='/shop/signup'> <button class='btn btn-primary'>Signup</button></a>" style="size:2px">-->
        pops="<a href='/shop/login'><button class='btn btn-primary'>Log-in</button></a><a href='/shop/signup'> <button class='btn btn-primary'>Signup</button></a>"
        document.getElementById('popcart1').setAttribute('data-content', pops);
    }
    else{
        pops='<a href="/shop/yourOrders">Your Orders</a><br><a onclick="clearmail()" href="/shop/signout">Sign out</a>'
        document.getElementById('popcart1').setAttribute('data-content', pops);
    }

    function clearmail()
    {
        mail = null
        localStorage.setItem('mail', null);
        pops="<a href='/shop/login'><button class='btn btn-primary'>Log-in</button></a><a href='/shop/signup'> <button class='btn btn-primary'>Signup</button></a>"
        document.getElementById('popcart1').setAttribute('data-content', pops);
    }

    // Find out the cart items from localStorage
    if (localStorage.getItem('cart') == null) {
        var cart = {};
    } else {
        cart = JSON.parse(localStorage.getItem('cart'));
        updateCart(cart);
    }
    // If the add to cart button is clicked, add/increment the item
    //$('.cart').click(function() {
    $('.divpr').on('click', 'button.cart', function() {
        var idstr = this.id.toString();
        if (cart[idstr] != undefined) {
            qty = cart[idstr][0] + 1;
        } else {
            qty = 1;
            name = document.getElementById('name'+idstr).innerHTML;
            console.log(name)
            price = document.getElementById('price'+idstr).innerHTML;
            console.log(price)
            cart[idstr] = [qty, name, parseInt(price)];
        }
        updateCart(cart);
    });
    //Add Popover to cart
    $('#popcart').popover();
    updatePopover(cart);

    function updatePopover(cart) {
        //        console.log('We are inside updatePopover');
        var popStr = "";
        popStr = popStr + "<div> <h5 style='text-align: center'>Your Cart</h5><hr></div><div class='mx-2 my-2'>";
        var i = 1;
        for (var item in cart) {
            popStr = popStr + "<b>" + i + "</b>. ";
            if ((cart[item][1]).length > 14) {
                popStr = popStr + (cart[item][1]).slice(0, 14) + "... | Qty: " + cart[item][0] + '<br>';
            } else if ((cart[item][1]).length <= 14) {
                popStr = popStr + (cart[item][1]) + " | Qty: " + cart[item][0] + '<br>';
            }
            i = i + 1;
        }
        popStr = popStr + "</div> <a href='/shop/checkout'><button class='btn btn-primary' id ='checkout'>Checkout</button></a> <button class='btn btn-primary' onclick='clearCart()' id ='clearCart'>Clear Cart</button>"
        document.getElementById('popcart').setAttribute('data-content', popStr);
<!--        if (screen.width > 991) {-->
<!--            $('#popcart').popover('show');-->
<!--        } else {-->
<!--            $('#popcart').popover();-->
<!--        }-->
    }


    function clearCart() {
        cart = JSON.parse(localStorage.getItem('cart'));
        for (var item in cart) {
            if (('div' + item) == ('divpr{{product.id}}')) {
                document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cart">Add To Cart</button>'
            }
        }
        localStorage.clear();
        cart = {};
        updateCart(cart);
    }


    function updateCart(cart) {
        var sum = 0;
        for (var item in cart) {
            sum = sum + cart[item][0];

            if (('div' + item) == ('divpr{{i.id}}')) {
                document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
            }
            //            else
            //            {
            //                document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
            //            }
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        document.getElementById('cart').innerHTML = sum;
        //        console.log(cart);
        updatePopover(cart);
    }
    // If plus or minus button is clicked, change the cart as well as the display value
    $('.divpr').on("click", "button.minus", function() {
        a = this.id.slice(7, );
        cart['pr' + a][0] = cart['pr' + a][0] - 1;
        cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
        //        document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
        if (cart['pr' + a][0] == 0) {
            document.getElementById('divpr' + a).innerHTML = '<button id="pr' + a + '" class="btn btn-primary cart">Add to Cart</button>';
            delete cart['pr' + a];
        } else {
            document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
        }
        updateCart(cart);
    });
    $('.divpr').on("click", "button.plus", function() {
        a = this.id.slice(6, );
        cart['pr' + a][0] = cart['pr' + a][0] + 1;
        document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
        updateCart(cart);
    });



</script>
{% endblock %}


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->

<!--<head>-->
<!--    <meta charset="utf-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">-->
<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">-->
<!--    &lt;!&ndash; Bootstrap CSS &ndash;&gt;-->
<!--    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital@1&display=swap" rel="stylesheet">-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Sriracha&display=swap" rel="stylesheet">-->
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
<!--    &lt;!&ndash;    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">&ndash;&gt;-->
<!--&lt;!&ndash;    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">&ndash;&gt;-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">-->

<!--    <title>Category</title>-->
